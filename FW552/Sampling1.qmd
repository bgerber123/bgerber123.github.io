---
title: <span style="color:orange">Sampling I</span>
title-slide-attributes:
  data-background-image: /img/26715873.jpg
  background-opacity: "0.45"
format:
  revealjs:
    chalkboard: true
---

## [Population and Sample]{style="color:#078BCD;"}
```{=html}
<style type="text/css">

code.r{
  font-size: 30px;
}
</style>
```

![](../img/sample.png)

. . .

Define 1) census, 2) sample, and 3) sampling?



## [Population and Sample]{style="color:#078BCD;"}

![](../img/sample.png)

To use a sample to describe a 'population' is called what?


## [Definitions]{style="color:#078BCD;"}{.scrollable}


- **Census?**
    - Complete enumeration of the population (i.e., the whole)

- **What is a sample?**
    - The act, process, or technique of selecting a representative part of a population for the purpose of determining parameters or characteristics of the whole
population 


- **What is sampling?**
    - Selection of a part of a population to be used to estimate characteristics of the population
    - To make inference about the population from a part, i.e., the sample.

## [Sampling Types]{style="color:#078BCD;"}

- [Convenient sampling]{style="color:cornflowerblue"} - when most convenient units are chosen
- [Judgment sampling]{style="color:cornflowerblue"} - obtained at the discretion of someone who is familiar with the characteristics of the population
- [Probability sampling]{style="color:cornflowerblue"} - based on a process that the probability a unit is selected is known 

## [Central paradox of Sampling]{style="color:#078BCD;"}

- Impossible to know from a sample whether it is representative

- We rely on the process, not the outcome.

## [Why Sample?]{style="color:#078BCD;"}

1) Large populations are physically prohibitive to census
2) Fiscally prohibitive to census
3) Timeliness
4) Observing might be destructive. For example?


## [Common Sample Units]{style="color:#078BCD;"}

. . .

- [plots/quadrats]{style="color:cornflowerblue"} - small area to measure/count plants, seeds, insects, etc.
- [points]{style="color:cornflowerblue"} - measurements are taken from a set of points established throughout a population
- [transects]{style="color:cornflowerblue"} - line segments in which observations are taken from
- [individual organisms]{style="color:cornflowerblue"} - the organism is the sample unit or the organism defines the location of the sample unit



## [Population and Sample]{style="color:#078BCD;"}

:::: {.columns}

::: {.column width="60%"}


 - Trees of sufficient size for nesting by spotted owls
 - House characteristics that northern flickers most often damage
 - Survival of rainbow trout in the presence of whirling disease
 - Surveys, e.g., number of people that
    - bird watch / hunt / fish / think wolves should live in CO



:::

::: {.column width="40%"}

![](../img/owl.trout.png){fig-align="center" width="250"}

:::

::::




## [Population and Sample]{style="color:#078BCD;"}

:::: {.columns}

::: {.column width="60%"}


[Often a spatial/temporal context to our target population
]{style="color:red;"}

:::

::: {.column width="40%"}

![](../img/owl.trout.png){fig-align="center" width="250"}

:::

::::



## [Population and Sample]{style="color:#078BCD;"}


<b>Title:</b> Muskrat occurrence in Rhode Island shows little evidence of land use change driving declines

<!-- **Clear target population and sample** -->


![](../img/muskratRI.png)

## [Population and Sample]{style="color:#078BCD;"}



<b>Title:</b> Land cover attributes affect the distribution of rooting damage by wild pigs (Sus scrofa)

::: {.r-fit-text}

- Surveys within 1) The Savannah River Site (green) 2)  Newberry County (blue), 3) Hampton County (red)
- "We generated 9 random points to act as the center of respective 200-ha survey grids".
- "Properties were primarily composed of mixed agricultural-forested cover".

:::

![](../img/rooting.SC.png) 

## [Thinking Backwards]{style="color:#078BCD;"}

:::: {.columns}

::: {.column width="60%"}

People often think backwards from what data they have to identify the Population.

::: {.r-fit-text}

E.g., Nesting shorebirds are censused each summer at a handful of beaches.

Can we use these sites as samples to apply to all beaches in the area?

:::

:::

::: {.column width="40%"}

![](../img/RI.beaches.png){fig-align="center" width="400"}

:::

::::

## [Design vs. Sampling]{style="color:#078BCD;"}

. . .

-   **Experimental Design:**
    - Deliberately perturbing a part of a 'population' to compare it's effect to a part that was not perturbed

-   **Sampling Design**: 
    - The process of obtaining a representative sample to characterize a 'population' w/o necessarily perturbing it.



## [Design- vs Model-based Infernce]{style="color:#078BCD;"}

What are important differences according to Thompson and Hankin et al.?

Benefits or costs of either?

. . .

**Important Considerations**

- randomness
- fixed
- undefinable infinite superpoulation vs. real target population

## [Design- vs Model-based Infernce]{style="color:#078BCD;"}

![](../img/designModel.png){fig-align="center"}

## [Design- vs Model-based Infernce]{style="color:#078BCD;"}

![](../img/forest.png)




## [Sample Language]{style="color:#078BCD;"}


:::: {.columns}

::: {.column width="40%"}

A sample (height in inches):

$\textbf{y} = [69, 54, 72, 61, 58, 71]$

<br>

A sample unit:

$y_{2} =54$ 

<br>

Sample size:

$n = 6$ 

:::

::: {.column width="60%"}

<br>
<br>
<br>
<br>
![](../img/census.sample.unit.png){fig-align="center" width="2200"}

:::

::::





## [More Language]{style="color:#078BCD;"}

**What is a statistic?**

. . .

- An estimate of a population parameter from a sample

. . .

$$\hat{\mu} = \left(\left(\sum_{i=1}^{n}y_{i}\right)\times \frac{1}{n}\right) = 57.7$$

- $n$ is a sample parameter (size of sample) 
- $\hat{\mu}$ is an estimate of a population parameter ($\mu$) from the estimator (mathematical rule for calculation) 
- 57.7 is a statistic (specific value)



## [More Language]{style="color:#078BCD;"}

$$\mu =\left(\sum_{i=1}^{N}y_{i}\right)\times \frac{1}{N} = 54$$

- $\mu$ is a population parameter (measure of central tendency)
- $N$ is a population parameter (size of all possible sample units) 
- $54$ is the value of the population parameter


## [Sampling Error]{style="color:#078BCD;"}

- **Sampling Error**
    - The difference b/w a sample statistic (specific value) and the true value of a population paramter
    - 57.7 - 54 = 3.3 (inches) sampling error
    - Due solely to incomplete enumeration of the population (chance)
    - Protection against this is large sample size


## [Sampling Variation and Error]{style="color:#078BCD;"}

**Target Population:** Weight of all black bears in a region

![](../img/bear.png){fig-align="center" width="600"}

. . .

How would you describe a *sampling frame* relevant to this target population?

## [Sampling Variation and Error]{style="color:#078BCD;"}

```{r, echo=FALSE}

# Create 'truth'
  set.seed(3433)
  pop.weights = rnorm(n = 500, mean = 300, sd = 50)

#Population mean
  pop.mu.weights = mean(pop.weights)

#Population standard deviation
  pop.sd.weights = sd(pop.weights)
  
# Sample Size  
  N = length(pop.weights)

# histogram    
  hist(pop.weights, main = "Total Population (N = 500)",freq=TRUE,xlim=c(0,700),xlab="Bear Weight (lbs)")  
```

## [Sampling Error]{style="color:#078BCD;"}

Vector of bear weights

```{r,echo=TRUE}
  pop.weights[1:5]
```

. . .

```{r,echo=TRUE}
# Sample Size
  n = 50

# Sample and estimate mean one time
  sample.1 = mean(
                  sample(pop.weights,
                         n,
                         replace = FALSE
                         )
                  )

# Calculate Sampling Error
  sample.1 - pop.mu.weights
```

. . .

:::{.r-stack}
**Is this a problem?**
:::


## [Sampling Variation vs Error]{style="color:#078BCD;"}

Sampling variation is the process and sampling error is an outcome.

<br>

The differences between samples (sampling variation) lead to differences between sample statistics and population parameters (sampling error). 


## [Sampling Variation]{style="color:#078BCD;"}

Calculate many many sample means

```{r, echo=TRUE}
# Create function to sample 50 units and take the mean
 sample.mean.fn = function(target,n){
                                     mean(
                                         sample(target,n)
                                          )
                                     }
# Repeat the above function 20000 times
  mu.hat = replicate(20000,
                     sample.mean.fn(pop.weights,n)
                     )

```

## [Sampling Variation]{style="color:#078BCD;"}

```{r, echo=FALSE}
par(mfrow=c(1,2))
hist(mu.hat,breaks=40,main = "Sampling Distribution \n of Sample Mean for n = 50",xlim=c(240,380),
     xlab=expression(hat(mu)))
abline(v=pop.mu.weights,lwd=3,col=2)
legend("topright",legend=c("Population Mean"),lwd=2,col=2,cex=0.8)
hist(mu.hat-pop.mu.weights,breaks=40,main = "Sampling Error for n = 50",
     xlab=expression(hat(mu)- mu))
```

## [Estimator Bias]{style="color:#078BCD;"}

<!-- We should be very interested in the characteristics of the sampling distribution and error. -->

Expected Bias (of the estimator) = average sample mean - population mean

. . .

$$
\text{Bias}(\hat{\mu},\mu) = \bar{\hat{\mu}} - \mu \\
$$

. . .

$$
\text{Bias}(\hat{\mu},\mu) = E[\hat\mu] - \mu \\
$$

. . .

$$
\text{Bias}(\hat{\mu},\mu) = \left(\int_{x} g(x)p(x|\mu)dx\right) - \mu
$$

. . .

Expectations are an average over all possible samples of size n.

## [Is our estimator biased?]{style="color:#078BCD;"}

```{r, echo=FALSE}
hist(mu.hat,breaks=40,main = "Sampling Distribution \n of Sample Mean for n = 50",xlim=c(240,380),
     xlab=expression(hat(mu)))
abline(v=pop.mu.weights,lwd=3,col=2)
```



## [Precision]{style="color:#078BCD;"}

```{r, echo=FALSE}
hist(mu.hat,breaks=40,main = "Sampling Distribution \n of Sample Mean for n = 50",xlim=c(240,380),
     xlab=expression(hat(mu)))
abline(v=pop.mu.weights,lwd=3,col=2)
```


[How close are repeated measures to each other?]{style="color:cornflowerblue"}


## [Probability]{style="color:#078BCD;"}

[We can also summarize the sampling variation into a probability]{style="color:cornflowerblue"}

<br>

. . .

For n = 50, how likely is it that one sample will be within 10% of the true population parameter?

```{r, echo=TRUE}
lower = pop.mu.weights - pop.mu.weights*0.05
upper = pop.mu.weights + pop.mu.weights*0.05

length(which(mu.hat > lower & mu.hat < upper)) / length(mu.hat)

```

## [Accuracy]{style="color:#078BCD;"}

[Typically a measure of how close the average sample value is to truth]{style="color:cornflowerblue"}

```{r echo=FALSE}
par(mfrow=c(2,2))
curve(dnorm(x, 300, 10),lwd=3,xlim=c(150,450),main="Unbiased & Accurate",xlab="Bear Weight (lbs)",
      ylab="Density")
abline(v=300,lwd=3,col=2)

curve(dnorm(x, 295, 10),lwd=3,xlim=c(150,450),main="Biased & Accurate",xlab="Bear Weight (lbs)",
      ylab="Density")
abline(v=300,lwd=3,col=2)

curve(dnorm(x, 290, 10),lwd=3,xlim=c(150,450),main="Biased & Inaccurate",xlab="Bear Weight (lbs)",
      ylab="Density")
abline(v=300,lwd=3,col=2)

curve(dnorm(x, 270, 10),lwd=3,xlim=c(150,450),main="Biased & Inaccurate",xlab="Bear Weight (lbs)",
      ylab="Density")
abline(v=300,lwd=3,col=2)
```


## [Sampling Variation]{style="color:#078BCD;"}

[Which sampling distribution would you prefer?]{style="color:cornflowerblue"}

```{r echo=FALSE}
par(mfrow=c(1,1))
curve(dnorm(x, 300, 50),lwd=3,xlim=c(150,450),ylim=c(0,0.04),xlab="Bear Weight (lbs)")
curve(dnorm(x, 310, 10),lwd=3,add=TRUE,col=3)
legend("topright",lwd=3,col=c(1,3,2),legend=c("Unbiased/Accurate/Imprecise",
                                            "Biased/Accurate/Precise",
                                            expression(mu)))
abline(v=300,lwd=3,col=2)
```


## [Sampling Bias]{style="color:#078BCD;"}

-  **Sampling Bias**
    - Systematic tendency of selecting certain sample units; makes the samples *unrepresentative* to the target population
    - Examples in fish/wildlife??


## [Sampling Bias]{style="color:#078BCD;"}

**Sample Population:** Weight of harvested black bears in a region that allows food provisioning

![](../img/beardonut.png){fig-align="center" width="400"}

## [Sampling Error and Bias]{style="color:#078BCD;"}

```{r, echo=FALSE}
  sample.pop.weights = pop.weights[which(pop.weights>300)]

par(mfrow=c(1,2))
  hist(pop.weights, main = "Total Population (N = 500)",freq=TRUE,xlim=c(0,500),xlab="Bear Weight")
  hist(sample.pop.weights, main = "Sample Population",col=2,freq=TRUE,xlim=c(0,500),xlab="Bear Weight")
```

## [Sampling Bias]{style="color:#078BCD;"}

We only sample harvested bears with food supplementation

```{r, echo=FALSE}
#Repeat the above function 20000 times
set.seed(54343)
mu.hat=replicate(20000,sample.mean.fn(sample.pop.weights,n))
par(mfrow=c(1,2))
hist(mu.hat,breaks=40,main = "Sampling Distribution \n of Sample Mean for n = 50",
     xlim=c(200,400),xlab=expression(hat(mu)))
abline(v=pop.mu.weights,lwd=3,col=2)
legend("topleft",legend=c("Population Mean"),lwd=2,col=2)
hist(mu.hat-pop.mu.weights,breaks=40,main = "Sampling Bias for n = 50",xlab=expression(hat(mu)- mu))
```

. . .

Expected Bias =  `r round(mean(mu.hat)- pop.mu.weights,digits=2)`



## [Sampling Bias]{style="color:#078BCD;"}

Relative Expected Bias = $\frac{E(\hat{\mu})-\mu}{\mu}$

Relative Expected Bias = `r round((mean(mu.hat)- pop.mu.weights)/pop.mu.weights,digits=2)`

## [Biased Estimator]{style="color:#078BCD;"}

We sample all bears but use a different estimator for the population mean

$$
\hat{\mu} = \left(\sum_{i=1}^{n}(y_{i})^{0.38}\right)\times \frac{1}{n^{1/10000}} 
$$


## [Biased Estimator]{style="color:#078BCD;"}

```{r, echo=FALSE}
#Repeat the above function 20000 times
biased.sample.mean.fn = function(x,n){
                                  temp=sample(x,n)
                                  sum(temp^0.38)/length(temp)^(1/10000)
}
set.seed(54343)
mu.hat=replicate(20000,biased.sample.mean.fn(pop.mu.weights,n))
par(mfrow=c(1,2))
hist(mu.hat,breaks=40,main = "Sampling Distribution \n of Sample Mean for n = 50",
     xlim=c(0,600))
abline(v=pop.mu.weights,lwd=3,col=2)
legend("topright",legend=c("Population Mean"),lwd=2,col=2,cex=0.8)
hist(mu.hat-pop.mu.weights,breaks=40,main = "Sampling Error for n = 50")
```

Expected Bias =  `r round(mean(mu.hat)- pop.mu.weights,digits=2)`

```{r,echo=FALSE, results='hide'}
#Output code into R file
knitr::purl(input="../FW552/Sampling1.qmd",output="../FW552/Sampling1.r")
```


## [Measurement Error]{style="color:#078BCD;"}

Didn't zero the scale before weighing; this is not sampling error. 

![](../img/bear.scale.png)

## [Measurement Error]{style="color:#078BCD;"}

Inaccurate measurements due to malfunctioning instruments or poor procedures or
by-product of sampling plan

<br>

. . .


E.g., 

  - In Aspen, CO human-bear conflicts tend to be under reported
  - In New Jersey they tend to be over reported

