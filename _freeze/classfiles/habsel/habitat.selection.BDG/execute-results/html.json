{
  "hash": "94c317c8f89e8f4d667ae0c1be362570",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Habitat Selection Availability Sensitivity\"\nauthor: \"Brian Gerber\"\ndate: \"2024-11-06\"\noutput: html_document\n---\n\n\n\n\n\n\n## Getting the data ready\n\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Look at deer data and spatial layers to be used as covariates\nforest.cover = readRDS(\"sp.layer.forest\")\nplot(forest.cover,main=\"Forest Cover\")\npoints(deer)\n```\n\n::: {.cell-output-display}\n![](habitat.selection.BDG_files/figure-html/data-1.png){width=672}\n:::\n\n```{.r .cell-code}\nshrub.cover = readRDS(\"sp.layer.shrub\")\nplot(shrub.cover,main=\"Standaradized Shrub Cover\")\n```\n\n::: {.cell-output-display}\n![](habitat.selection.BDG_files/figure-html/data-2.png){width=672}\n:::\n:::\n\n\n\n\n\n## Assignment\n\nConduct a sensitivity analysis to investigate how many available samples are needed for the slope coeficients to be estimated with minimal approximation error. Consider a range of sizes for the available sample between 50 and 500,000. Fit the same model (case_ ~ forest + cover) to each of these datasets. Extract the slope coeficients for the variables 'forest' and 'cover'. Creat an x-y line plot with these estimates (y-axis) and the size of the available sample (x-axis). Determine generally when the coefficient estimates stabilize. A common recommendation in the literature is to used a 1:1 ratio between used locations and available samples. If you had only fit the model with this size of available how off would your estimates be from the correct/converged/well approximated estimates when using a large available sample. \n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Take a really large sample of available locations (the zeros)\n  rsf.dat.large <- random_points(deer, n = 4000000) |> \n                   extract_covariates(forest.cover) |>\n                   extract_covariates(shrub.cover) \n\n# Decide on how to subset the available samples\n  availables = c(50,100,500,1000,10000,100000,1000000,2000000,3000000,4000000)\n\n# Find the indices of where the deer locations are (index.1)  and the available samples (index.0)\n  index.0 = which(rsf.dat.large$case_==0)\n  index.1 = which(rsf.dat.large$case_==1)\n  coef.mat=NULL\n\n# Loop through the numbers of available samples and iteratively grab an increase set of zeros. Combine\n# these zeros with the used locations of deer and then fit the model \n  for(i in 1:length(availables)){\n    rsf.smaller =  rbind(rsf.dat.large[index.1,],rsf.dat.large[index.0[1:availables[i]],])\n    fit = glm(case_~forest+shrub.cover, data=rsf.smaller,family=binomial(link=\"logit\"))\n    coef.mat=rbind(coef.mat,coef(fit)[c(2,3)])\n  }\n\nknitr::kable(cbind(availables,coef.mat))\n```\n\n::: {.cell-output-display}\n\n\n| availables|     forest| shrub.cover|\n|----------:|----------:|-----------:|\n|      5e+01| -0.6887266|   0.0406996|\n|      1e+02| -0.5134734|  -0.3117284|\n|      5e+02|  0.2009326|  -0.1663946|\n|      1e+03|  0.1970181|  -0.1573290|\n|      1e+04|  0.1684757|  -0.1455294|\n|      1e+05|  0.1836227|  -0.1433593|\n|      1e+06|  0.1935036|  -0.1421465|\n|      2e+06|  0.1926889|  -0.1429547|\n|      3e+06|  0.1894583|  -0.1426449|\n|      4e+06|  0.1905065|  -0.1420496|\n\n\n:::\n:::\n\n\n\n\n\nWe can see that the first and second decimal place values converges for both coefficients by 100,000 available samples. \n\nNext, lets specifically compare the converged estimated coefficients to estimates when using a 1:1 ratio of used:available.\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nrsf.dat <- random_points(deer, n = nrow(deer)) |> \n             extract_covariates(forest.cover) |>\n             extract_covariates(shrub.cover) \n\nfit = glm(case_~forest+shrub.cover, \n          data=rsf.dat,\n          family=binomial(link=\"logit\"))\nsummary(fit)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n\nCall:\nglm(formula = case_ ~ forest + shrub.cover, family = binomial(link = \"logit\"), \n    data = rsf.dat)\n\nCoefficients:\n            Estimate Std. Error z value Pr(>|z|)\n(Intercept)  0.01344    0.07583   0.177    0.859\nforest       0.15616    0.17513   0.892    0.373\nshrub.cover -0.09752    0.06461  -1.509    0.131\n\n(Dispersion parameter for binomial family taken to be 1)\n\n    Null deviance: 2290.2  on 1651  degrees of freedom\nResidual deviance: 2285.4  on 1649  degrees of freedom\nAIC: 2291.4\n\nNumber of Fisher Scoring iterations: 3\n```\n\n\n:::\n\n```{.r .cell-code}\n# Absolute difference b/w converged and non-converged estimates\n(coef.mat[10,] - coef(fit)[2:3])\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n     forest shrub.cover \n 0.03434588 -0.04453154 \n```\n\n\n:::\n:::\n\n\n\n\nWe can see that if we had used a 1:1 ratio of used to available, we would have underestimated the effect of forest and overestimated the effect of shrub cover.",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}