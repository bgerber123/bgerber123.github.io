{
  "hash": "a08d7187f177f737586a23a6fd144029",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Study Design Evaluation of Estimating White-tailed Deer Abundance in Rhode Island, USA\"\nauthor: \"Brian D. Gerber\"\ndate: \"2024-07-31\"\noutput: html_document\n---\n\n\n<style type=\"text/css\">\n\nbody, td {\n   font-size: 16px;\n}\ncode.r{\n  font-size: 16px;\n}\npre {\n  font-size: 16px\n}\n</style>\n\n\n# **Report**\n\n**Main Take-Away:** the objective can not be met at the sample sizes investigated.\n\n## Context\n\nI evaluate sampling design trade-offs in estimating total white-tailed deer abundance in the state of Rhode Island, USA. I consider two extremes of deer density - 1 deer/mi$^2$ and 20 deer/mi$^2$. For each deer density, I use a random sampling process to choose blocks of 1 mi$^2$ to conduct a forward-looking infrared-red (FLIR) count of deer. The count is presumed to be done by helicopter with a FLIR camera attachment. Flights are assumed to occur in the winter and at night to increase the heat signature of deer. As such, detection probability within a block is assumed to be one (this however should be evaluated). I evaluate three sample sizes of 10, 20, and 40 blocks. The objective is to find the sample size that minimizes costs while being highly certain (0.90 probability) that the total population estimate is within 10% of the true value. This study design evaluation is done by using design-based sampling and inference. \n\n## Setup\n\n\n\n\n::: {.cell}\n\n:::\n\n\nI considered the sampling frame to include all one square mile blocks of contiguous lands in Rhode Island that have less than 80% 'development'.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# find values of high development  \n  index=which(RI$Devel_area>0.8)\n\n# drop values of high development and make a new spatial object\n  RI=RI[-index,]\n\n# Update the id column\n  RI$Id=1:nrow(RI)\n\n# plot updated map\n  plot(RI[\"Devel_area\"])\n```\n\n::: {.cell-output-display}\n![](RI-Deer-Sampling_BDG_files/figure-html/plot.sampling.frame-1.png){width=672}\n:::\n:::\n\n\nThere are no current studies to suggest the true mean deer density or the spatial structure of the Rhode Island deer population. As such, I will simulate two scenarios that consider a low (1 deer/mi$^2$) and high mean deer density (20 deer/mi$^2$).\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Mean deer per square mile (1 cell)\n  deer.dens=c(1,20)\n\n# Total expected deer populations\n  deer.dens*nrow(RI)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1]   944 18880\n```\n\n\n:::\n\n```{.r .cell-code}\n# Simulate deer densities\n  set.seed(434343)\n  deer1=rpois(nrow(RI),deer.dens[1])\n  deer2=rpois(nrow(RI),deer.dens[2])\n  \n  par(mfrow=c(1,2))\n  hist(deer1,freq=FALSE, main=\"True distribution - mean 1 mi^2\")\n  hist(deer2,freq=FALSE, main=\"True distribution - mean 20 mi^2\")\n```\n\n::: {.cell-output-display}\n![](RI-Deer-Sampling_BDG_files/figure-html/truth-1.png){width=672}\n:::\n:::\n\n\nThe assumed true total population size for both scenarios are 905 and 18800, respectively. These populations include random spatial variation. Considering additional spatial structure, such as variation in deer density by the percentage of development (`Devel_area`) could be a useful exercise. \n\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](RI-Deer-Sampling_BDG_files/figure-html/stuff-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](RI-Deer-Sampling_BDG_files/figure-html/stuff-2.png){width=672}\n:::\n:::\n\n\n  \n## Simulation\n\nI will consider sampling both populations with three different samples sizes (10, 20, and 40). For each sample size, I will simulate random samples 1000 times. This will not evaluate all possible combinations of samples for each size, but it will be enough to approximate the sampling distribution. This can be evaluated by looking at the symmetry of the sampling distribution. Highly skewed and non-symmetric sampling distributions will require a higher number of simulations. \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n  sample.sizes = c(10, 20, 40)\n  n.sim = 1000\n```\n:::\n\n::: {.cell}\n\n:::\n\n\nThe below code is shown to make it clear how exactly the sampling and estimation is done There are two for loops. One (index `z`) that loops through the number of sample sizes and the other (index `i`) that loops through the the number of simulation iterations within each sample sample. \n\nThe important code is the use of the function `grts` that selects a spatially balanced sample from the areal sampling frame and the estimation of the mean deer size for each cell using the function `mean`.  There is no model used to estimate and predict the total deer abundanec. Rather, I am using the mean as the estimator. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Start code timer and Loop over sample size choices\n  tic(\"simulation\")\n  for(z in 1:length(sample.sizes)){\n  \n  # For each sample size, repeat the \n  # sampling/estimation criteria n.sim times\n    for(i in 1:n.sim){  \n        set.seed(434343+i) #defined random number generation\n        eqprob <- grts(RI, n_base = sample.sizes[z])\n        y1=eqprob$sites_base$Deer1\n        y2=eqprob$sites_base$Deer2\n        est1=mean(y1)\n        est2=mean(y2)\n        deer.total.abundance1[z,i]=est1*nrow(RI)\n        deer.total.abundance2[z,i]=est2*nrow(RI)\n    \n      #monitor loops\n      if(i%%10==0) cat(\"\\nz =\",z, \", i =\", i)\n    } #End i loop\n  };toc() #End z loop and End codetimer\n```\n:::\n\n\n\n<!-- # First thing to do is save our results -->\n<!--   #save(deer.total.abundance,file=\"deer.total.abundance.BDG\") -->\n\n<!-- # If already run and saved, load the results.   -->\n<!--   #load(\"deer.total.abundance.BDG\") -->\n\n## Results\n\nFirst, examining the absolute bias of the estimator, we see that for the low deer density there to be low bias across sample sizes (10, 20, 40): 12.85, -1.17, -2.06, respectively. The relative bias puts these results in proportion to the size of the true population size: 0.01, 0, 0, making it more clear how little bias there is. Some of this is likely Markov error, such that increasing the number of simulations would drive these values even lower. The results are similar for the high deer density scenario, where the absolute bias is -51.88, 22.6, -21.5, and the relative bias is 0, 0, 0.\n\n\n\nLooking at the sampling distributions for low and deer density, we see the range of possible deer population sizes shrink towards the true value as the sample size increases.\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](RI-Deer-Sampling_BDG_files/figure-html/plotting-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](RI-Deer-Sampling_BDG_files/figure-html/plotting-2.png){width=672}\n:::\n:::\n\n\nThe range (min-max) of possible total deer population estimates at the low deer density for sample sizes (10, 20, and 40) are: \n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n      10   20   40\nmin  189  236  519\nmax 1794 1510 1345\n```\n\n\n:::\n:::\n\n\nThe same results for the high deer density are:\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n       10    20    40\nmin 14726 16048 16756\nmax 23128 21901 21476\n```\n\n\n:::\n:::\n\n\n<br>\n<br>\n\n\nTo specifically address the objective of this study, I found that the probability (given the assumed true low deer density and random sampling) of obtaining a single sample at the three different sample sizes (10, 20, and 40) to be substantially lower than the desired probability of 0.90.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Probability of means being within 10% of truth - low deer density\napply(deer.total.abundance1,1,FUN=function(x){\n  low=true.total1-true.total1*0.05\n  upp=true.total1+true.total1*0.05\n  length(which(x>low & x<upp))/length(x)\n})\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.129 0.176 0.274\n```\n\n\n:::\n:::\n\n\nHigher probabilities were found under the high deer density, but still do not meet the goal of 90%:\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 0.496 0.703 0.865\n```\n\n\n:::\n:::\n\n\n\n## Conclusion\n\nConsidering low and high deer densities, I found that the objective to be highly certain (0.90 probability) that a single estimate of the total population estimate is within 10% of the true value can not be met at sample sizes of 10, 20, and 40. A sample size of 50 may reach the goal at the high deer density, but a much larger sample size will be need if deer densities are low. However, there is very little bias in the estimator at either low or high deer densities.\n\n# **Appendix**\n\n\n## Software\n\nThis report was generated from the R Statistical Software (v4.2.2; R Core Team 2021) using the [Markdown language](https://www.markdownguide.org/) and [RStudio](https://posit.co/products/open-source/rstudio/). The R packages used are acknowledged below. \n\n\n::: {.cell}\n::: {.cell-output-display}\n\n\n|Package    |Version |Citation                                       |\n|:----------|:-------|:----------------------------------------------|\n|base       |4.4.1   |@base                                          |\n|doParallel |1.0.17  |@doParallel                                    |\n|foreach    |1.5.2   |@foreach                                       |\n|knitr      |1.47    |@knitr2014; @knitr2015; @knitr2024             |\n|rmarkdown  |2.27    |@rmarkdown2018; @rmarkdown2020; @rmarkdown2024 |\n|sf         |1.0.16  |@sf2018; @sf2023                               |\n|spsurvey   |5.5.1   |@spsurvey                                      |\n|tictoc     |1.2.1   |@tictoc                                        |\n|tidyverse  |2.0.0   |@tidyverse                                     |\n\n\n:::\n:::\n",
    "supporting": [
      "RI-Deer-Sampling_BDG_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}