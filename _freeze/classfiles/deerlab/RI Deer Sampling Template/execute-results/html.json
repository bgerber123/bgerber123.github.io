{
  "hash": "9017a7793776f411d6670a2f7ef4f389",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"My title\"\nauthor: \"Author\"\ndate: \"Date\"\noutput: html_document\n---\n\n\n<style type=\"text/css\">\n\nbody, td {\n   font-size: 16px;\n}\ncode.r{\n  font-size: 16px;\n}\npre {\n  font-size: 16px\n}\n</style>\n\n\n# **Report**\n\n**Main Take-Away:** \n\n## Context\n\nIn this report, I evaluate sampling design trade-offs in estimating total white-tailed deer abundance in the state of Rhode Island, USA. I consider two extremes of deer density - 1 deer/mi$^2$ and 20 deer/mi$^2$. For each deer density, I use a random sampling process to choose blocks of 1 mi$^2$ to conduct a forward-looking infrared-red (FLIR) count of deer. The count is presumed to be done by helicopter with a FLIR camera attachment. Flights are assumed to occur in the winter and at night to increase the heat signature of deer. As such, detection probability within a block is assumed to be one (this however should be evaluated). I evaluate three sample sizes of 10, 20, and 40 blocks. The objective is to find the sample size that minimizes costs while being highly certain (0.90 probability) that the total population estimate is within 10% of the true value. This study design evaluation is done by using design-based sampling and inference. \n\n## Setup\n\n\n::: {.cell}\n\n:::\n\n\nI considered the sampling frame to include all one square mile blocks of contiguous lands in Rhode Island that have less than 80% 'development'.\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# find values of high development  \n  index=which(RI$Devel_area>0.8)\n\n# drop values of high development and make a new spatial object\n  RI=RI[-index,]\n\n  # Update the id column\n  RI$Id=1:nrow(RI)\n\n# plot updated map\n  plot(RI[\"Devel_area\"])\n```\n\n::: {.cell-output-display}\n![](RI-Deer-Sampling-Template_files/figure-html/plot.sampling.frame-1.png){width=672}\n:::\n:::\n\n\nThere are no current studies to suggest the true mean deer density or the spatial structure of the Rhode Island deer population. As such, I will simulate two scenarios that consider a low (1 deer/mi$^2$) and high mean deer density (20 deer/mi$^2$).\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Mean deer per square mile (1 cell)\n  deer.dens=c(1,20)\n\n# Total expected deer populations\n  deer.dens*nrow(RI)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1]   944 18880\n```\n\n\n:::\n\n```{.r .cell-code}\n# Simulate deer densities\n  set.seed(434343)\n  deer1=rpois(nrow(RI),deer.dens[1])\n  deer2=rpois(nrow(RI),deer.dens[2])\n  \n  par(mfrow=c(1,2))\n  hist(deer1,freq=FALSE, main=\"True distribution - mean 1 mi^2\")\n  hist(deer2,freq=FALSE, main=\"True distribution - mean 20 mi^2\")\n```\n\n::: {.cell-output-display}\n![](RI-Deer-Sampling-Template_files/figure-html/truth-1.png){width=672}\n:::\n:::\n\n\nThe assumed true total population size for both scenarios are 905 and 18800, respectively. These populations include random spatial variation. Considering additional spatial structure, such as variation in deer density by the percentage of development (`Devel_area`) could be a useful exercise. \n\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](RI-Deer-Sampling-Template_files/figure-html/stuff-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](RI-Deer-Sampling-Template_files/figure-html/stuff-2.png){width=672}\n:::\n:::\n\n\n  \n## Simulation\n\nI will consider sampling both populations with three different samples sizes (10, 20, and 40). For each sample size, I will simulate random samples 1000 times. This will not evaluate all possible combinations of samples for each size, but it will be enough to approximate the sampling distribution. This can be evaluated by looking at the symmetry of the sampling distribution. Highly skewed and non-symmetric sampling distributions will require a higher number of simulations. \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n  sample.sizes = c(10, 20, 40)\n  n.sim = 1000\n```\n:::\n\n::: {.cell}\n\n:::\n\n\nThe below code is shown to make it clear how exactly the sampling and estimation is done There are two for loops. One (index `z`) that loops through the number of sample sizes and the other (index `i`) that loops through the the number of simulation iterations within each sample sample. \n\nThe important code is the use of the function `grts` that selects a spatially balanced sample from the areal sampling frame and the estimation of the mean deer size for each cell using the function `mean`.  There is no model used to estimate and predict the total deer abundanec. Rather, I am using the mean as the estimator. \n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Here, I am demonstrating random sampling one time and for one sample size and then using that random sample to estimate the total deer population for low and high scenarios.\n  sample.size=10\n  eqprob <- grts(RI, n_base = sample.size)\n  y1=eqprob$sites_base$Deer1\n  y2=eqprob$sites_base$Deer2\n  est1=mean(y1)\n  est2=mean(y2)\n  deer.total.abundance1=est1*nrow(RI)\n  deer.total.abundance2=est2*nrow(RI)\n```\n:::\n\n\n## Results\n\nFirst, examining the absolute bias of the estimator, we see . . .\n\n\nLooking at the sampling distributions for low and high deer density, we see ....\n\n\nThe range (min-max) of possible total deer population estimates at low and high deer density for sample sizes (10, 20, and 40) are: \n\n\nTo specifically address the objective of this study, I used Monte Carlo integration to estimate the probability a single total deer density would be within 10% of truth. I found....\n\n\n## Conclusion\n\nConsidering low and high deer densities, I found that the objective to be highly certain (0.90 probability) that a single estimate of the total population estimate is within 10% of the true value....\n\n# **Appendix**\n\n\n## Software\n\nThis report was generated from the R Statistical Software (v4.2.2; R Core Team 2021) using the [Markdown language](https://www.markdownguide.org/) and [RStudio](https://posit.co/products/open-source/rstudio/). The R packages used are acknowledged below. \n\n\n::: {.cell}\n::: {.cell-output-display}\n\n\n|Package    |Version |Citation                                       |\n|:----------|:-------|:----------------------------------------------|\n|base       |4.4.1   |@base                                          |\n|doParallel |1.0.17  |@doParallel                                    |\n|foreach    |1.5.2   |@foreach                                       |\n|knitr      |1.47    |@knitr2014; @knitr2015; @knitr2024             |\n|rmarkdown  |2.27    |@rmarkdown2018; @rmarkdown2020; @rmarkdown2024 |\n|sf         |1.0.16  |@sf2018; @sf2023                               |\n|spsurvey   |5.5.1   |@spsurvey                                      |\n|tictoc     |1.2.1   |@tictoc                                        |\n|tidyverse  |2.0.0   |@tidyverse                                     |\n\n\n:::\n:::\n",
    "supporting": [
      "RI-Deer-Sampling-Template_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}