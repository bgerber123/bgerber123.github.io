{
  "hash": "6569890d87e0c2f3a0e99ceccb29eb25",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: <span style=\"color:orange\"></span>\ntitle-slide-attributes:\n  data-background-image: /img/cluster.png\n  background-opacity: \"0.45\"\nformat:\n  revealjs:\n    scrollable: true\n#    slide-level: 1\n    theme: simple\n    slide-number: true\n    show-slide-number: all\n    html:\n         page-layout: full\n---\n\n\n## [Cluster and systematic sampling]{style=\"color:#078BCD;\"}\n\n```{=html}\n<style type=\"text/css\">\n\ncode.r{\n  font-size: 30px;\n}\n</style>\n```\n\n\n::: {.cell}\n\n:::\n\n\nAppear to be opposites\n\n- [Cluster]{style=\"color:red;\"}: units are clumped together\n- [Systematic]{style=\"color:red;\"}: units spaced out\n\n. . .\n\nBoth partition sampling into *primary* and *secondary* units\n\n. . .\n\n- [Cluster]{style=\"color:red;\"}: primary units consist of cluster of secondary units\n- [Systematic]{style=\"color:red;\"}: primary unit consists of secondary units that are arranged via a rule set\n\n\n## [Cluster and systematic sampling]{style=\"color:#078BCD;\"}\n\n\n![](../img/cluster2.png)\n\n## [Boreal Toad Case Study]{style=\"color:#078BCD;\"}\n\n:::: {.columns}\n\n::: {.column width=\"50%\"}\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped\" style=\"font-size: 30px; width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Pond </th>\n   <th style=\"text-align:right;\"> egg.mass </th>\n   <th style=\"text-align:right;\"> cluster </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> A </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> B </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> C </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> D </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> E </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> F </td>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n:::\n\n::: {.column width=\"50%\"}\n\n- N = 3\n- $\\mu =8$\n- n = 1\n- $M_i$ = 2 (secondary/primary)\n- $M = \\sum_{\\forall i} M_i$ \n:::\n\n::::\n\n![](../img/borealtoad.png)\n\n\n## [Cluster Estimators]{style=\"color:#078BCD;\"}\n\n- $i^{th}$ primary and $j^{th} secondary$\n\n$$\ny_i = \\sum_{j=1}^{M_i} y_{ij}\n$$\n\n$$\n\\bar{y} = \\hat{\\mu}_{\\text{primary}} = \\frac{1}{n}\\sum_{i=1}^{n} y_{i}\n$$\n\n$$\n\\hat{\\sigma}^2_{\\mu} = \\frac{1}{n-1} \\sum_{i=1}^n(y_i -\\hat{\\mu})^2\n$$\n\n\n\n## [Boreal toad]{style=\"color:#078BCD;\"}{.scrollable}\n\n\n#### Cluster sampling scheme A\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped\" style=\"font-size: 30px; width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> clusterA </th>\n   <th style=\"text-align:right;\"> member1 </th>\n   <th style=\"text-align:right;\"> member2 </th>\n   <th style=\"text-align:right;\"> mean </th>\n   <th style=\"text-align:right;\"> dev2 </th>\n   <th style=\"text-align:right;\"> var </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 9 </td>\n   <td style=\"text-align:right;\"> 4.5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:right;\"> 11 </td>\n   <td style=\"text-align:right;\"> 9 </td>\n   <td style=\"text-align:right;\"> 4.5 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n$$\\sum_{i=1}^3(\\hat{\\mu}_{i}-\\mu) = 0 $$ \n\n\n## [Boreal toad]{style=\"color:#078BCD;\"}{.scrollable}\n\n\n#### Cluster sampling scheme A\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped\" style=\"font-size: 30px; width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> clusterA </th>\n   <th style=\"text-align:right;\"> member1 </th>\n   <th style=\"text-align:right;\"> member2 </th>\n   <th style=\"text-align:right;\"> mean </th>\n   <th style=\"text-align:right;\"> dev2 </th>\n   <th style=\"text-align:right;\"> var </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 9 </td>\n   <td style=\"text-align:right;\"> 4.5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:right;\"> 11 </td>\n   <td style=\"text-align:right;\"> 9 </td>\n   <td style=\"text-align:right;\"> 4.5 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n$$\nE[\\hat{\\sigma}^{2}_{\\mu}] = 3\\\\\n$$\n\n\n## [Cluster Sampling]{style=\"color:#078BCD;\"}\n\nSuperficial resemblance to stratification: 'clustered' sample units are grouped like a stratum\n\n**Selection process is different**\n\n- [stratification]{style=\"color:#078BCD;\"}: every strata is part of the sampling process\n    - not all units in each strata are sampled\n- [cluster]{style=\"color:#078BCD;\"}: select among clusters in same way as SRS\n    - then observe all units within cluster\n\n. . .\n\n**Cluster sampling is really SRS applied to groups of population members**\n\n\n## [Cluster sampling scheme B]{style=\"color:#078BCD;\"}\n\n*Make cluster of similar values*\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped\" style=\"font-size: 30px; width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Pond </th>\n   <th style=\"text-align:right;\"> egg.mass </th>\n   <th style=\"text-align:right;\"> clusterB </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> A </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> B </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> C </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> D </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> E </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> F </td>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n## [Cluster sampling scheme B]{style=\"color:#078BCD;\"}\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped\" style=\"font-size: 30px; width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> clusterB </th>\n   <th style=\"text-align:right;\"> member1 </th>\n   <th style=\"text-align:right;\"> member2 </th>\n   <th style=\"text-align:right;\"> mean </th>\n   <th style=\"text-align:right;\"> dev2 </th>\n   <th style=\"text-align:right;\"> var </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:right;\"> 8.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 9 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:right;\"> 11 </td>\n   <td style=\"text-align:right;\"> 9 </td>\n   <td style=\"text-align:right;\"> 4.5 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n$$\\sum_{i=1}^3(\\hat{\\mu}_{i}-\\mu) = 0 $$ \n\n## [Cluster sampling scheme B]{style=\"color:#078BCD;\"}\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped\" style=\"font-size: 30px; width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> clusterB </th>\n   <th style=\"text-align:right;\"> member1 </th>\n   <th style=\"text-align:right;\"> member2 </th>\n   <th style=\"text-align:right;\"> mean </th>\n   <th style=\"text-align:right;\"> dev2 </th>\n   <th style=\"text-align:right;\"> var </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:right;\"> 8.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 9 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:right;\"> 11 </td>\n   <td style=\"text-align:right;\"> 9 </td>\n   <td style=\"text-align:right;\"> 4.5 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n$$\nE[\\hat{\\sigma}^{2}_{\\mu}] = 8.67\n$$\n\n\n## [Cluster sampling scheme C]{style=\"color:#078BCD;\"}\n\n*Make clusters of dissimilar values*\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped\" style=\"font-size: 30px; width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Pond </th>\n   <th style=\"text-align:right;\"> egg.mass </th>\n   <th style=\"text-align:right;\"> clusterC </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> A </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> B </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> C </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> D </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> E </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> F </td>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n## [Cluster sampling scheme C]{style=\"color:#078BCD;\"}\n\n*Make clusters of dissimilar values*\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped\" style=\"font-size: 30px; width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> clusterC </th>\n   <th style=\"text-align:right;\"> member1 </th>\n   <th style=\"text-align:right;\"> member2 </th>\n   <th style=\"text-align:right;\"> mean </th>\n   <th style=\"text-align:right;\"> dev2 </th>\n   <th style=\"text-align:right;\"> var </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:right;\"> 7 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 9 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.5 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n$$\\sum_{i=1}^3(\\hat{\\mu}_{i}-\\mu) = 0 $$ \n\n\n## [Cluster sampling scheme C]{style=\"color:#078BCD;\"}\n\n*Make clusters of dissimilar values*\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped\" style=\"font-size: 30px; width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> clusterC </th>\n   <th style=\"text-align:right;\"> member1 </th>\n   <th style=\"text-align:right;\"> member2 </th>\n   <th style=\"text-align:right;\"> mean </th>\n   <th style=\"text-align:right;\"> dev2 </th>\n   <th style=\"text-align:right;\"> var </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:right;\"> 7 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.5 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 9 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 0.5 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n\n\n$$\nE[\\hat{\\sigma}^{2}_{\\mu}] = 0.67\n$$\n\n\n## [Cluster sampling scheme D]{style=\"color:#078BCD;\"}\n\n*Clusters of dissimilar values and size*\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped\" style=\"font-size: 30px; width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Pond </th>\n   <th style=\"text-align:right;\"> egg.mass </th>\n   <th style=\"text-align:right;\"> clusterD </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> A </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> B </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> C </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> D </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> E </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> F </td>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n## [Cluster sampling scheme D]{style=\"color:#078BCD;\"}\n\n*Clusters of dissimilar values and size*\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped\" style=\"font-size: 30px; width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> clusterD </th>\n   <th style=\"text-align:right;\"> member1 </th>\n   <th style=\"text-align:right;\"> member2 </th>\n   <th style=\"text-align:right;\"> member3 </th>\n   <th style=\"text-align:right;\"> mean </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 5.33 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 10.00 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> NA </td>\n   <td style=\"text-align:right;\"> 12.00 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n- mean(c(5.33,10,12)) = 9.11\n- 9.11 - 8 = 1.11 (biased)\n\n## [Cluster sampling scheme D]{style=\"color:#078BCD;\"}\n\n*Need to incorporate cluster size*\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped\" style=\"font-size: 30px; width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> clusterD </th>\n   <th style=\"text-align:right;\"> mean </th>\n   <th style=\"text-align:right;\"> clusterSize </th>\n   <th style=\"text-align:right;\"> SizeXMean </th>\n   <th style=\"text-align:right;\"> divide.avg.cluster.size </th>\n   <th style=\"text-align:right;\"> dev2 </th>\n   <th style=\"text-align:right;\"> var </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 5.33 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 16 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 10.00 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 20 </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 12.00 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n- mean(c(8,10,6)) = 8\n- 8 - 8 = 0 (unbiased)\n- $E[\\hat{\\sigma}^{2}] = 1.33$\n\n## [Variable-sizeed clusters]{style=\"color:#078BCD;\"}\n\n**We randomly select the primary units**\n\n- the number of secondary units may be quite different and not in our control (i.e., random variable)\n\n<br>\n\n. . .\n\nYou want to know something about households\n\n- sample home addresses (building is cluster; primary unit)\n- the number of secondary units depends on building type \n    - single-family house, condo/duplex, apartment complex\n\n\n## [Cluster sampling]{style=\"color:#078BCD;\"}\n\n- Maximize precision by forming clusters that have varying values within secondary units\n- Overall cluster values (e.g., mean) are similar (aggregated secondary units)\n\n## [But....]{style=\"color:#078BCD;\"}\n\n\nIn our field we often think of forming clusters by location\n\n. . .\n\n<br>\n\n**First Law of Geography**: \"*everything is related to everything else, but near things are more related than distant things*.\" - Waldo Tobler\n\n. . . \n\n<br>\n\nThis contradicts the principal and utility of cluster sampling.\n\n## [Cluster sampling]{style=\"color:#078BCD;\"}\n\nBut also need to consider costs b/w SRS and cluster.\n\n. . .\n\n**Which do you think is more likely to less costly?**\n\n\n<!-- ## [Cluster sampling vs SRS]{style=\"color:#078BCD;\"} -->\n\n<!-- ![](../img/mushroom.png) -->\n\n<!-- Colleague wants to take a sample of n = 100 plots to measure *mushroom abundance* -->\n\n<!-- ## [Cluster sampling vs SRS]{style=\"color:#078BCD;\"} -->\n\n<!-- - Could take random sample of 100 plots -->\n<!-- - Could take random sample of 50 clusters (primary) with 2 plots each (secondary). -->\n\n<!-- **WHAT DO YOU RECOMMEND?** -->\n\n\n\n## [Pika Case Study]{style=\"color:#078BCD;\"}\n\nWe are interested in the total population size of pika across 10 mountains\n\n![](../img/pika2.png)\n\n## [Pika Case Study]{style=\"color:#078BCD;\"}\n\n**Goal:** Compare Cluster and SR sampling\n\n. . .\n\n- 10 Mtns\n- Each mtn can be divide into 100 plots based on talus slopes (piles of rocks and boulders)\n- a total (N) of 10 x 100 sample units (in a SRS sense).\n\n. . .\n\n- we expect the most deviation to occur across mountains, rather than in them.\n- we will cluster our samples across mountains (aggregate plots across mtns)\n\n## [Pika Case Study]{style=\"color:#078BCD;\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Simulate a true population\n  N.plots= 100 # talus slope plots\n  N.mtns= 10 # mtns\n\n# Create matrix of counts\n  pop = matrix(NA, N.plots, N.mtns)\n\n# Consider each mtn has a different mean abundance\n# This forces the mtns to vary in pika abundance\n  mu = seq(1,100,length.out = N.mtns)\n\n# Loop over each mountain and draw N.plots random values from that specific mean\n# log transform the mean and the exponentiate then round to make them counts \n# and to ensure values are never negative\nfor(j in 1:N.mtns){\n  set.seed(143453543+j)\n  pop[,j] = round(\n                  exp(\n                      rnorm(N.plots,\n                            log(mu[j]),\n                            0.1\n                            )\n                      ),\n                  digits=0\n                  )\n}\n```\n:::\n\n\n\n## [Pika Case Study]{style=\"color:#078BCD;\"}\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Cluster_files/figure-revealjs/unnamed-chunk-14-1.png){width=960}\n:::\n:::\n\n\n- SRS $n = 100$ random units\n\n## [Pika Case Study]{style=\"color:#078BCD;\"}\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Cluster_files/figure-revealjs/unnamed-chunk-15-1.png){width=960}\n:::\n:::\n\n\n- clusters are columns \n\n\n## [Pika Case Study]{style=\"color:#078BCD;\"}\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Cluster_files/figure-revealjs/unnamed-chunk-16-1.png){width=960}\n:::\n:::\n\n\n- $N_\\text{Primary Cluster} = 100$ with $N_\\text{Secondary} = 10$ \n- $n_\\text{Primary Cluster} = 10$ with $n_\\text{Secondary} = 10$ \n\n\n## [Pika Case Study]{style=\"color:#078BCD;\"}\n\n\n::: {.cell}\n\n:::\n\n\n- **The same number of total units are sampled:  100**\n\n- $\\mu =$ 50.67\n\n- $\\tau =$ 50670\n\n## [Setup Simulation]{style=\"color:#078BCD;\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# SRS\n  # Total number of secondary sample units for SRS\n    N = N.plots*N.mtns\n  # Sample size of secondary units for SRS  \n    n=100\n\n# Clusters\n   # Number of primary units (plot across mtns)\n    N.primary = 100\n\n  # Plots per cluster (mtn); seconary unit\n    N.secondary = 10\n```\n:::\n\n\n  \n\n\n## [SRS]{style=\"color:#078BCD;\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\n#Number of simulated studies / replicate samples  \nn.sim= 10000\n  \n# Create SRS function  \nsrs.fun = function(pop){\n  \n  # Get a sample of indices\n  index=sample(1:(N.plots*N.mtns),size=n)\n  \n  # Use those indices to get our population counts in each sample unit\n  y = c(pop)[index]\n  \n  #Total estimate\n  tau.est=mean(y)*N\n  \n  #Standard deviation of total \n  tau.sd=sqrt(N*(N-n)*(var(y)/n))\n\n  list(tau.est=tau.est,\n       tau.sd=tau.sd)\n}\n\n# replicate!\nsrs.total.dist=replicate(n.sim, srs.fun(pop))\n```\n:::\n\n\n\n## [SRS]{style=\"color:#078BCD;\"}\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Cluster_files/figure-revealjs/unnamed-chunk-20-1.png){width=960}\n:::\n:::\n\n\n$\\sigma_{\\hat{\\tau},SRS} =$ 3109.66\n\n## [Cluster]{style=\"color:#078BCD;\"}\n\n\n::: {.cell}\n\n```{.r .cell-code}\ncluster.fun = function(pop){\n  #Get index of plots (clusters) to sample across mtn rnages and sample all within that cluster\n  index=sample(1:N.primary, size = 10)\n  \n  y = pop[index,] # this is 10x10 (total of 100 sample units)\n  y.sum = apply(y,1,sum)\n  \n  tau.est = N.primary*mean(y.sum)\n\n  #Standard deviation of total \n  var.primary= var(y.sum)\n  tau.sd = sqrt(N.primary*(N.primary-N.secondary)*(var.primary/N.secondary))\n  \n  list(tau.est=tau.est,\n       tau.sd=tau.sd)\n    \n}\n\n# Replicate!!!!\n  cluster.total.dist=replicate(n.sim, cluster.fun(pop))\n```\n:::\n\n\n## [Cluster]{style=\"color:#078BCD;\"}\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Cluster_files/figure-revealjs/unnamed-chunk-22-1.png){width=960}\n:::\n:::\n\n\n$\\sigma_{\\hat{\\tau},Cluster} =$ 554.26\n\n## [SRS vs Cluster]{style=\"color:#078BCD;\"}\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Cluster_files/figure-revealjs/unnamed-chunk-23-1.png){width=960}\n:::\n:::\n\n\n\n## [SRS vs Cluster]{style=\"color:#078BCD;\"}\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Cluster_files/figure-revealjs/unnamed-chunk-24-1.png){width=960}\n:::\n:::\n\n\n## [Why did Clusters work so well?]{style=\"color:#078BCD;\"}\n\nThompson pg. 137: \"The relative efficiency of the cluster (or systematic) sample to the simple random sample of equivalent sample size, defined as the ratio of variances\",\n\n$$\n\\frac{\\text{var}(\\tau_{srs})}{\\text{var}(\\tau_{\\mu})} = \\frac{\\text{var}(\\text{across all values in population})}{\\text{var}(\\text{across secondary units})}\n$$\n\n. . .\n\n#### Numerator\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 1045.07\n```\n\n\n:::\n:::\n\n\n#### Denominator\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 342.1313\n```\n\n\n:::\n:::\n\n\n\n## [Take home]{style=\"color:#078BCD;\"}\n\nCluster sampling will lead to more precise estimates than SRS (at the same sample size) when units within clusters vary more than on average than do the units in the whole sampling frame. \n\n<br>\n\n. . .\n\nThe greater variation within clusters, the grater precision of cluster sampling; **opposite of stratified sampling**\n\n<br>\n\n\n\n## [Take home]{style=\"color:#078BCD;\"}\n\n**Beware**\n\n<br>\n\nClusters require good knowledge of the system. \n\nA poor choice could lead to increasing sampling distribution variance. \n\n\n## [Systematic Sample]{style=\"color:#078BCD;\"}\n\n![](../img/ferret.png)\n\nBlack-footed ferret breeding program for release into the wild.\n\n. . .\n\n- 10 groups of 10 animals (separate colonies)\n- each as a number 1 to 10\n\n\n## [Systematic Sample]{style=\"color:#078BCD;\"}\n\n*How do we choose which two individuals to release into the wild?*\n\n- randomly select a number... 3\n- randomly select a new number w/o replacement... 7\n\n. . .\n\nYou systematically have selected individual 3 and 7 for release from each colony/group.\n\n\n## [Systematic Sample]{style=\"color:#078BCD;\"}\n\n![](../img/systematic.grid.png)\n\n- people like the \"spatial balance\"\n\n## [Systematic Sample]{style=\"color:#078BCD;\"}\n\n- Can be biased\n    - plots may be more dissimilar than random\n      - mean is unbiased\n      - variance is too large\n    - periodicity (ridge/valley/ridge...)\n      - mean is biased\n      - variance is underestimated\n      ",
    "supporting": [
      "Cluster_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ],
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}