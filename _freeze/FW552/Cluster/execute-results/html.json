{
  "hash": "38276b2a6a7271843147470c6e1ba72d",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: <span style=\"color:orange\">Cluster/Systematic Sampling</span>\ntitle-slide-attributes:\n  data-background-image: /img/cluster.png\n  background-opacity: \"0.45\"\nformat:\n  revealjs:\n    scrollable: true\n#    slide-level: 1\n    theme: simple\n    slide-number: true\n    show-slide-number: all\n    html:\n         page-layout: full\n---\n\n\n## [Cluster and systematic sampling]{style=\"color:#078BCD;\"}\n\n```{=html}\n<style type=\"text/css\">\n\ncode.r{\n  font-size: 30px;\n}\n</style>\n```\n\n\n::: {.cell}\n\n:::\n\n\nAppear to be opposites\n\n- Cluster: units are clumped together\n- Systematic: units spaced out\n\n. . .\n\nBoth partition sampling into *primary* and *secondary* units\n\n. . .\n\n- Cluster: primary units consist of cluster of secondary \n- Systematic: primary unit consists of secondary units that are systematically arranged (rule set)\n\n\n![](../img/cluster2.png)\n\n## Boreal toad egg masses per pond in RMNP\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped\" style=\"font-size: 30px; width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Pond </th>\n   <th style=\"text-align:right;\"> egg.mass </th>\n   <th style=\"text-align:right;\"> cluster </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> A </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> B </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> C </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> D </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> E </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> F </td>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n- N = 6\n- $\\mu =8$\n\n\n## Boreal toad egg masses per pond in RMNP{.scrollable}\n\n#### Cluster sampling scheme A\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped\" style=\"font-size: 30px; width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> cluster </th>\n   <th style=\"text-align:right;\"> member1 </th>\n   <th style=\"text-align:right;\"> member2 </th>\n   <th style=\"text-align:right;\"> mean </th>\n   <th style=\"text-align:right;\"> dev2 </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 5 </td>\n   <td style=\"text-align:right;\"> 9 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:right;\"> 11 </td>\n   <td style=\"text-align:right;\"> 9 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n. . .\n\n$$\\sum_{i=1}^3(\\hat{\\mu}_{i}-\\mu) = 0 $$ \n. . .\n\n$$\n\\hat{\\sigma}^{2} = \\frac{1}{3}\\sum_{i=1}^{n} \\left(\\hat{\\mu}_{i}-\\mu\\right)^{2} = 6\n$$\n\n. . .\n\n**Recall that the variance for SRS was 4.26**\n\n. . .\n\n\n## Cluster Sampling\n\nSuperficial resemblance to stratification: 'clustered' sample units are grouped like a stratum\n\n**Selection process is different**\n\n- stratification: every strata is part of the sampling process\n- cluster: select among clusters in same way as SRS\n    - then observe all units within cluster\n\n. . .\n\nCluster sampling is really SRS applied to groups of population members\n\n\n## Cluster sampling scheme B\n\n*Make cluster of similar values*\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped\" style=\"font-size: 30px; width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Pond </th>\n   <th style=\"text-align:right;\"> egg.mass </th>\n   <th style=\"text-align:right;\"> cluster </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> A </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> B </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> C </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> D </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> E </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> F </td>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n## Cluster sampling scheme B\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped\" style=\"font-size: 30px; width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> cluster </th>\n   <th style=\"text-align:right;\"> member1 </th>\n   <th style=\"text-align:right;\"> member2 </th>\n   <th style=\"text-align:right;\"> mean </th>\n   <th style=\"text-align:right;\"> dev2 </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 4 </td>\n   <td style=\"text-align:right;\"> 16 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 9 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:right;\"> 11 </td>\n   <td style=\"text-align:right;\"> 9 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n. . .\n\n$$\\sum_{i=1}^3(\\hat{\\mu}_{i}-\\mu) = 0 $$ \n. . .\n\n$$\n\\hat{\\sigma}^{2} = \\frac{1}{3}\\sum_{i=1}^{n} \\left(\\hat{\\mu}_{i}-\\mu\\right)^{2} = 8.67\n$$\n\n\n## Cluster sampling scheme C\n\n*Make clusters of similar values*\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped\" style=\"font-size: 30px; width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:left;\"> Pond </th>\n   <th style=\"text-align:right;\"> egg.mass </th>\n   <th style=\"text-align:right;\"> cluster </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> A </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> B </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> C </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> D </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 3 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> E </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> F </td>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n## Cluster sampling scheme C\n\n*Make clusters of dissimilar values*\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table class=\"table table-striped\" style=\"font-size: 30px; width: auto !important; margin-left: auto; margin-right: auto;\">\n <thead>\n  <tr>\n   <th style=\"text-align:right;\"> cluster </th>\n   <th style=\"text-align:right;\"> member1 </th>\n   <th style=\"text-align:right;\"> member2 </th>\n   <th style=\"text-align:right;\"> mean </th>\n   <th style=\"text-align:right;\"> dev2 </th>\n  </tr>\n </thead>\n<tbody>\n  <tr>\n   <td style=\"text-align:right;\"> 1 </td>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 12 </td>\n   <td style=\"text-align:right;\"> 7 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 2 </td>\n   <td style=\"text-align:right;\"> 6 </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:right;\"> 3 </td>\n   <td style=\"text-align:right;\"> 8 </td>\n   <td style=\"text-align:right;\"> 10 </td>\n   <td style=\"text-align:right;\"> 9 </td>\n   <td style=\"text-align:right;\"> 1 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n. . .\n\n$$\\sum_{i=1}^3(\\hat{\\mu}_{i}-\\mu) = 0 $$ \n. . .\n\n$$\n\\hat{\\sigma}^{2} = \\frac{1}{3}\\sum_{i=1}^{n} \\left(\\hat{\\mu}_{i}-\\mu\\right)^{2} = 0.67\n$$\n\n## Cluster sampling \n\n- Maximize precision by forming clusters that have varying values within secondary units\n- Overall cluster values (i.e., mean) are similar\n\n. . .\n\n*BUT*, in our field we often think of forming clusters by location \n\n. . .\n\nFirst Law of Geography: \"everything is related to everything else, but near things are more related than distant things.\" - Waldo Tobler\n\n. . . \n\nThis contradicts the principal and utility of cluster sampling.\n\n\n\n\n## Cluster sampling vs SRS\n\n![](../img/mushroom.png)\n\nColleague wants to take a sample of n = 100 plots to measure *mushroom abundance*\n\n- Could take random sample of 100 plots\n- Could take random sample of 50 clusters (primary) with 2 plots each (secondary).\n\n\n**WHAT DO YOU RECOMMEND?**\n\n\n\n## Pika Case Study\n\nWe are interested in the total population size of pika across 10 mountains\n\n![](../img/pika2.png)\n\n\n- 10 Mtns\n- Each mtn can be divide into 100 plots based on talus slopes (piles of rocks and boulders)\n- a total of 10 x 100 sample units (in a SRS sense).\n- we expect the most deviation to occur across mountains, rather than in them.\n- we will cluster our samples across mountains (aggrgate plots across mtns)\n\n## Pika Case Study\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Simulate a true population\n  N.plots= 100 # talus slope plots\n  N.mtns= 10 # mtns\n\n# Create matrix of counts\n  pop = matrix(0,N.plots,N.mtns)\n\n# Consider each mtn has a different mean abundance\n# This forces the mtns to vary in pika abundance\n  mu = seq(1,100,length.out=N.mtns)\n\n# Loop over each mountain and draw N.plots random values from that specific mean\n# log transform the mean and the exponentiate then round to make them counts \n# and to ensure values are never negative\nfor(j in 1:N.mtns){\n  set.seed(143453543+j)\n  pop[,j] = round(exp(rnorm(N.plots,log(mu[j]),0.1)),digits=0)\n}\n```\n:::\n\n\n\n## Pika Case Study\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Cluster_files/figure-revealjs/unnamed-chunk-8-1.png){width=960}\n:::\n:::\n\n\n\n## Pika Case Study\n\n\n::: {.cell}\n\n:::\n\n\n$\\mu = $ 50.67\n\n$\\tau = $ 5.067\\times 10^{4}\n\n. . .\n\n#### Setup Simulation to compare SRS vs Cluster\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 100\n```\n\n\n:::\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 10\n```\n\n\n:::\n:::\n\n\nImportantly, the same number of total units are sampled:  100  \n\n\n## SRS\n\n\n::: {.cell}\n\n:::\n\n\n\n## SRS\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Cluster_files/figure-revealjs/unnamed-chunk-12-1.png){width=960}\n:::\n:::\n\n\n$\\sigma_{\\hat{\\tau},SRS} = $ 3109.6570815\n\n## Cluster\n\n\n::: {.cell}\n\n:::\n\n\n## Cluster\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Cluster_files/figure-revealjs/unnamed-chunk-14-1.png){width=960}\n:::\n:::\n\n\n$\\sigma_{\\hat{\\tau},Cluster} = $ 554.2570844\n\n## SRS vs Cluster\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Cluster_files/figure-revealjs/unnamed-chunk-15-1.png){width=960}\n:::\n:::\n\n\n\n## SRS vs Cluster\n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](Cluster_files/figure-revealjs/unnamed-chunk-16-1.png){width=960}\n:::\n:::\n\n\n### Why did Clusters work so well?\n\nThompson pg. 137: \"The relative efficiency of the cluster (or systematic) sample to the simple random sample of equivalent sample size, defined as the ratio of variances\",\n\n$$\n\\frac{\\text{var}(\\tau_{srs})}{\\text{var}(\\tau_{\\mu})} = \\frac{\\text{var}(\\text{across all values in population})}{\\text{var}(\\text{across secondary units})}\n\n$$\n. . .\n\n### Numerator\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 1045.07\n```\n\n\n:::\n:::\n\n\n### Denominator\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] 342.1313\n```\n\n\n:::\n:::\n",
    "supporting": [
      "Cluster_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ],
      "include-after-body": [
        "\n<script>\n  // htmlwidgets need to know to resize themselves when slides are shown/hidden.\n  // Fire the \"slideenter\" event (handled by htmlwidgets.js) when the current\n  // slide changes (different for each slide format).\n  (function () {\n    // dispatch for htmlwidgets\n    function fireSlideEnter() {\n      const event = window.document.createEvent(\"Event\");\n      event.initEvent(\"slideenter\", true, true);\n      window.document.dispatchEvent(event);\n    }\n\n    function fireSlideChanged(previousSlide, currentSlide) {\n      fireSlideEnter();\n\n      // dispatch for shiny\n      if (window.jQuery) {\n        if (previousSlide) {\n          window.jQuery(previousSlide).trigger(\"hidden\");\n        }\n        if (currentSlide) {\n          window.jQuery(currentSlide).trigger(\"shown\");\n        }\n      }\n    }\n\n    // hookup for slidy\n    if (window.w3c_slidy) {\n      window.w3c_slidy.add_observer(function (slide_num) {\n        // slide_num starts at position 1\n        fireSlideChanged(null, w3c_slidy.slides[slide_num - 1]);\n      });\n    }\n\n  })();\n</script>\n\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}